---
layout: post
title: "DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning"
date: 2025-01-22 15:19:35
author: "DeepSeek AI Research"
categories: ["Paper Reviews", "Reinforcement Learning"]
tags: ["Large-Scale-Reinforcement-Learning-on-Base-Model", "Group-Relative-Policy-Optimization", "Reasoning-Oriented-Reinforcement-Learning", "Reinforcement-Learning-with-Cold-Start", "Distillation-of-Reasoning-Capability", "Multi-Stage-Reinforcement-Learning-with-Self-Critique", "Rejection-Sampling-and-Supervised-Fine-Tuning", "Iterative-Reinforcement-Learning", "Verifiable-Rewards-Reinforcement-Learning", "Unified-Paradigm-for-Reinforcement-Learning"]
cover: /assets/images/default.jpg
use_math: true
---
### TL;DR
#### 이 연구를 시작하게 된 배경과 동기는 무엇입니까?

대규모 언어 모델의 추론 능력 향상은 인공지능 연구에서 가장 중요한 도전 과제 중 하나로 자리 잡고 있습니다. 기존의 언어 모델들은 대부분 지도 학습에 의존하여 추론 능력을 개발해왔지만, 이는 대량의 고품질 레이블된 데이터를 필요로 하며 모델의 자율적인 학습 잠재력을 제한한다는 근본적인 한계가 있었습니다. 특히 수학, 코딩, 과학적 추론과 같은 복잡한 문제 해결 영역에서 모델들은 여전히 인간 수준의 추론 능력에 도달하지 못하고 있었습니다.

DeepSeek-AI 연구팀은 이러한 한계를 극복하기 위해 순수한 강화학습을 통해 대규모 언어 모델의 추론 능력을 개발할 수 있는 혁신적인 접근법을 탐구하게 되었습니다. 그들의 핵심 연구 질문은 다음과 같았습니다. 지도 학습 데이터 없이 모델이 스스로 복잡한 추론 전략을 학습할 수 있을까? 이는 인공지능 시스템의 자율학습 잠재력을 탐구하는 근본적인 도전이자 기회였습니다.

#### 이 연구에서 제시하는 새로운 해결 방법은 무엇입니까?

연구팀은 **DeepSeek-R1-Zero**와 **DeepSeek-R1**이라는 두 가지 혁신적인 모델을 개발했습니다. DeepSeek-R1-Zero는 어떠한 지도 학습 미세 조정 데이터도 사용하지 않고 기본 모델에 직접 강화학습을 적용한 최초의 모델입니다. 이 모델은 **Group Relative Policy Optimization (GRPO)** 알고리즘을 활용하여 모델이 스스로 추론 능력을 개발할 수 있도록 설계되었습니다.

DeepSeek-R1은 DeepSeek-R1-Zero의 한계를 극복하기 위해 개발되었습니다. 소량의 콜드 스타트 데이터와 다단계 훈련 파이프라인을 도입하여 모델의 추론 능력을 더욱 향상시켰습니다. 특히 연구팀은 언어 일관성 보상과 같은 혁신적인 기법을 통해 모델의 추론 과정에서 발생할 수 있는 언어 혼용 문제를 완화했습니다. 또한 거부 샘플링과 지도 학습 미세 조정을 통해 모델의 일반화 능력을 크게 개선했습니다.

#### 제안된 방법은 어떻게 구현되었습니까?

DeepSeek-R1의 구현은 매우 정교한 다단계 접근법을 따랐습니다. 첫 번째 단계는 콜드 스타트 데이터 수집으로, 연구팀은 수천 개의 긴 체인 오브 소트 데이터를 큐레이션했습니다. 이 데이터는 모델의 초기 강화학습 액터를 미세 조정하는 데 사용되었으며, 가독성과 일관성을 높이기 위해 특별한 형식 `|special_token|<reasoning_process>|special_token|<summary>`을 도입했습니다.

두 번째 단계는 추론 지향 강화학습으로, DeepSeek-V3-Base 모델에 대규모 강화학습을 적용했습니다. 이 과정에서 연구팀은 언어 일관성 보상을 도입하여 모델의 추론 과정에서 발생할 수 있는 언어 혼용 문제를 완화했습니다. 세 번째 단계는 거부 샘플링과 지도 학습 미세 조정으로, 약 80만 개의 샘플을 사용하여 모델의 추론 및 일반 능력을 동시에 향상시켰습니다.

#### 이 연구의 결과가 가지는 의미는 무엇입니까?

DeepSeek-R1은 다양한 벤치마크에서 OpenAI-o1-1217과 비교할 만한 성능을 달성했습니다. AIME 2024에서 79.8%, MATH-500에서 97.3%, Codeforces에서 2,029 Elo 등급을 기록하며 추론, 수학, 코딩 분야에서 탁월한 성능을 입증했습니다. 특히 주목할 만한 점은 증류 과정을 통해 작은 모델들(Qwen-1.5B, Qwen-7B 등)도 놀라운 추론 능력을 획득할 수 있었다는 것입니다.

이 연구는 단순한 기술적 성과를 넘어 인공지능의 자율학습 가능성에 대한 중요한 통찰을 제공합니다. 지도 학습 데이터 없이도 모델이 스스로 복잡한 추론 전략을 개발할 수 있음을 보여주었으며, 강화학습이 대규모 언어 모델의 능력 향상에 있어 강력한 도구가 될 수 있음을 입증했습니다. 향후 연구에서는 일반 능력 향상, 언어 혼용 문제 해결, 프롬프트 엔지니어링 최적화 등을 통해 더욱 발전된 추론 모델을 개발할 수 있을 것으로 기대됩니다.

</summary></reasoning_process>
- - -
# DeepSeek-R1: 강화학습을 통한 대규모 언어 모델의 추론 능력 향상

## 초록

DeepSeek-AI에서는 첫 번째 세대 추론 모델인 DeepSeek-R1-Zero와 DeepSeek-R1을 소개합니다. DeepSeek-R1-Zero는 지도 학습 미세 조정 없이 대규모 강화학습만으로 훈련된 모델로, 놀라운 추론 능력을 보여줍니다. 강화학습 과정을 통해 DeepSeek-R1-Zero는 자연스럽게 다양하고 강력한 추론 행동들을 습득하게 되었습니다. 하지만 가독성 문제와 언어 혼용 현상과 같은 한계점들이 발견되었습니다.

이러한 문제들을 해결하고 추론 성능을 더욱 향상시키기 위해 DeepSeek-R1이 개발되었습니다. DeepSeek-R1은 다단계 훈련과 콜드 스타트 데이터를 활용하여 OpenAI-o1-1217과 비교할 만한 성능을 달성했습니다. 연구 커뮤니티를 지원하기 위해 DeepSeek-R1-Zero, DeepSeek-R1, 그리고 Qwen과 Llama 기반의 6개 밀집 모델들(1.5B, 7B, 8B, 14B, 32B, 70B)을 오픈소스로 공개합니다.

![DeepSeek-R1 벤치마크 성능](https://arxiv.org/html/2501.12948/x1.png)

위 그림은 다양한 벤치마크에서 DeepSeek-R1의 성능을 보여줍니다. AIME 2024, Codeforces, GPQA Diamond, MATH-500, MMLU, SWE-bench Verified 등의 과제에서 DeepSeek-R1, OpenAI-01-1217, DeepSeek-R1-32B, OpenAI-01-mini, DeepSeek-V3 등 여러 모델들의 성능을 Pass@1, 백분위수, 해결률 등의 지표로 비교하고 있습니다. 이 비교를 통해 각 모델의 능력을 파악하고 연구자들과 실무자들이 적절한 모델을 선택하는 데 도움을 줄 수 있습니다.

## 서론

최근 몇 년간 대규모 언어 모델들은 급속한 발전을 거듭하며 인공일반지능(AGI)과의 격차를 점차 줄여나가고 있습니다. 특히 사후 훈련이 전체 훈련 파이프라인의 중요한 구성 요소로 부상했습니다. 사후 훈련은 상대적으로 적은 계산 자원으로도 추론 과제의 정확도를 향상시키고, 사회적 가치와 일치시키며, 사용자 선호도에 맞춰 모델을 조정할 수 있는 것으로 입증되었습니다.

추론 능력의 맥락에서 OpenAI의 o1 시리즈 모델들은 체인 오브 소트 추론 과정의 길이를 늘려 추론 시간 스케일링을 도입한 최초의 모델입니다. 이러한 접근법은 수학, 코딩, 과학적 추론 등 다양한 추론 과제에서 상당한 성능 향상을 달성했습니다. 하지만 효과적인 테스트 시간 스케일링의 과제는 여전히 연구 커뮤니티에게 열린 문제로 남아 있습니다.

이전 연구들은 프로세스 기반 보상 모델, 강화학습, 몬테카를로 트리 탐색과 빔 탐색 같은 탐색 알고리즘 등 다양한 접근법을 탐구해왔습니다. 하지만 이러한 방법들 중 어느 것도 OpenAI의 o1 시리즈 모델과 비교할 만한 일반적인 추론 성능을 달성하지 못했습니다.

본 논문에서는 순수한 강화학습을 사용하여 언어 모델의 추론 능력을 향상시키는 첫 번째 단계를 제시합니다. 목표는 지도 데이터 없이 대규모 언어 모델이 추론 능력을 개발할 수 있는 잠재력을 탐구하고, 순수한 강화학습 과정을 통한 자기 진화에 집중하는 것입니다.

구체적으로 DeepSeek-V3-Base를 기본 모델로 사용하고 GRPO를 강화학습 프레임워크로 채택하여 추론에서의 모델 성능을 향상시켰습니다. 훈련 과정에서 DeepSeek-R1-Zero는 자연스럽게 수많은 강력하고 흥미로운 추론 행동들을 습득했습니다. 수천 번의 강화학습 단계를 거친 후, DeepSeek-R1-Zero는 추론 벤치마크에서 뛰어난 성능을 보였습니다. 예를 들어, AIME 2024에서 pass@1 점수가 15.6%에서 71.0%로 향상되었고, 다수결 투표를 통해 86.7%까지 개선되어 OpenAI-o1-0912와 동등한 성능을 달성했습니다.

하지만 DeepSeek-R1-Zero는 가독성 문제와 언어 혼용 현상과 같은 한계점들에 직면했습니다. 이러한 문제들을 해결하고 추론 성능을 더욱 향상시키기 위해 소량의 콜드 스타트 데이터와 다단계 훈련 파이프라인을 통합한 DeepSeek-R1을 개발했습니다.

또한 DeepSeek-R1에서 더 작은 밀집 모델들로의 증류를 탐구했습니다. Qwen2.5-32B를 기본 모델로 사용한 DeepSeek-R1로부터의 직접 증류는 해당 모델에 강화학습을 적용하는 것보다 더 나은 성능을 보였습니다. 이는 더 큰 기본 모델에서 발견된 추론 패턴이 추론 능력 향상에 중요함을 보여줍니다.

### 주요 기여

**사후 훈련: 기본 모델에 대한 대규모 강화학습**

지도 학습 미세 조정을 사전 단계로 거치지 않고 기본 모델에 직접 강화학습을 적용했습니다. 이러한 접근법을 통해 모델이 복잡한 문제 해결을 위한 체인 오브 소트를 탐구할 수 있게 되어 DeepSeek-R1-Zero가 개발되었습니다. DeepSeek-R1-Zero는 자기 검증, 성찰, 긴 체인 오브 소트 생성과 같은 능력을 보여주며, 연구 커뮤니티에게 중요한 이정표가 되었습니다. 특히 지도 학습 미세 조정 없이 순수한 강화학습만으로 대규모 언어 모델의 추론 능력을 향상시킬 수 있음을 검증한 최초의 공개 연구입니다.

또한 DeepSeek-R1 개발을 위한 파이프라인을 소개합니다. 이 파이프라인은 개선된 추론 패턴 발견과 인간 선호도 정렬을 목표로 하는 두 개의 강화학습 단계와, 모델의 추론 및 비추론 능력의 씨앗 역할을 하는 두 개의 지도 학습 미세 조정 단계를 포함합니다.

**증류: 작은 모델도 강력할 수 있다**

더 큰 모델의 추론 패턴을 더 작은 모델로 증류할 수 있으며, 이는 작은 모델에서 강화학습을 통해 발견된 추론 패턴보다 더 나은 성능을 보임을 입증했습니다. DeepSeek-R1에서 생성된 추론 데이터를 사용하여 연구 커뮤니티에서 널리 사용되는 여러 밀집 모델들을 미세 조정했습니다. 평가 결과 증류된 작은 밀집 모델들이 벤치마크에서 뛰어난 성능을 보였습니다. DeepSeek-R1-Distill-Qwen-7B는 AIME 2024에서 55.5%를 달성하여 QwQ-32B-Preview를 능가했습니다. 또한 DeepSeek-R1-Distill-Qwen-32B는 AIME 2024에서 72.6%, MATH-500에서 94.3%, LiveCodeBench에서 57.2%를 기록했습니다.

### 평가 결과 요약

**추론 과제**: DeepSeek-R1은 AIME 2024에서 79.8% Pass@1을 달성하여 OpenAI-o1-1217을 약간 능가했습니다. MATH-500에서는 97.3%라는 인상적인 점수를 기록하여 OpenAI-o1-1217과 동등한 성능을 보이며 다른 모델들을 크게 앞섰습니다. 코딩 관련 과제에서는 Codeforces에서 2,029 Elo 등급을 달성하여 경쟁 참가자의 96.3%를 능가하는 전문가 수준의 성능을 보였습니다.

**지식**: MMLU, MMLU-Pro, GPQA Diamond 등의 벤치마크에서 DeepSeek-R1은 뛰어난 결과를 달성했습니다. MMLU에서 90.8%, MMLU-Pro에서 84.0%, GPQA Diamond에서 71.5%를 기록하여 DeepSeek-V3를 크게 능가했습니다. 이러한 벤치마크에서 OpenAI-o1-1217보다는 약간 낮은 성능을 보였지만, 다른 폐쇄형 모델들을 능가하여 교육 과제에서의 경쟁력을 입증했습니다.

**기타 능력**: DeepSeek-R1은 창의적 글쓰기, 일반적인 질의응답, 편집, 요약 등 광범위한 과제에서도 뛰어난 성능을 보였습니다. AlpacaEval 2.0에서 87.6%의 길이 조정 승률과 ArenaHard에서 92.3%의 승률을 달성하여 시험 지향적이지 않은 질의를 지능적으로 처리하는 강력한 능력을 보여주었습니다. 또한 긴 맥락 이해가 필요한 과제에서도 뛰어난 성능을 보여 DeepSeek-V3를 크게 능가했습니다.
이 섹션에서는 DeepSeek-R1-Zero와 DeepSeek-R1의 개발 접근법을 상세히 다루고 있습니다. 기존 연구들이 지도 학습 데이터에 크게 의존했던 것과 달리, 본 연구는 지도 학습 미세 조정 없이도 대규모 강화학습만으로 추론 능력을 크게 향상시킬 수 있음을 보여줍니다. 더 나아가 소량의 콜드 스타트 데이터를 포함하면 성능을 더욱 개선할 수 있다는 점을 입증합니다.

## 접근법 개요

연구진은 두 가지 주요 모델을 제시합니다. 첫째, DeepSeek-R1-Zero는 어떠한 지도 학습 미세 조정 데이터도 사용하지 않고 기본 모델에 직접 강화학습을 적용한 모델입니다. 둘째, DeepSeek-R1은 수천 개의 긴 체인 오브 소트 예시로 미세 조정된 체크포인트에서 시작하여 강화학습을 적용한 모델입니다. 마지막으로 DeepSeek-R1의 추론 능력을 작은 밀집 모델들로 증류하는 과정도 포함됩니다.

## DeepSeek-R1-Zero: 기본 모델에서의 강화학습

강화학습은 이전 연구들에서 추론 과제에 상당한 효과를 보여주었지만, 이러한 연구들은 수집하기 어려운 지도 데이터에 크게 의존했습니다. 본 연구에서는 대규모 언어 모델이 지도 데이터 없이도 추론 능력을 개발할 수 있는 잠재력을 탐구하며, 순수한 강화학습 과정을 통한 자기 진화에 집중합니다.

### 강화학습 알고리즘: Group Relative Policy Optimization

훈련 비용을 절약하기 위해 연구진은 Group Relative Policy Optimization (GRPO)를 채택했습니다. 이 알고리즘은 일반적으로 정책 모델과 같은 크기인 비평 모델을 사용하지 않고, 대신 그룹 점수로부터 기준선을 추정합니다.

구체적으로 각 질문 $q$에 대해 GRPO는 이전 정책 $\pi_{\theta_{old}}$로부터 출력 그룹 $\{o_1, o_2, \cdots, o_G\}$를 샘플링하고, 다음 목적 함수를 최대화하여 정책 모델 $\pi_\theta$를 최적화합니다.

$$\mathcal{J}_{GRPO}(\theta) = \mathbb{E}[q\sim P(Q),\{o_{i}\}_{i=1}^{G}\sim\pi_{\theta_{old}}(O|q)] \frac{1}{G}\sum_{i=1}^{G}\left(\min\left(\frac{\pi_{\theta}(o_{i}|q)}{\pi_{\theta_{old}}(o_{i}|q)}A_{i},\text{clip}\left(\frac{\pi_{\theta}(o_{i}|q)}{\pi_{\theta_{old}}(o_{i}|q)},1-\varepsilon,1+\varepsilon\right)A_{i}\right)-\beta\mathbb{D}_{KL}\left(\pi_{\theta}||\pi_{ref}\right)\right)$$

여기서 KL 발산은 다음과 같이 정의됩니다.

$$\mathbb{D}_{KL}\left(\pi_{\theta}||\pi_{ref}\right)=\frac{\pi_{ref}(o_{i}|q)}{\pi_{\theta}(o_{i}|q)}-\log\frac{\pi_{ref}(o_{i}|q)}{\pi_{\theta}(o_{i}|q)}-1$$

$\varepsilon$과 $\beta$는 하이퍼파라미터이며, $A_i$는 각 그룹 내 출력들에 해당하는 보상 그룹 $\{r_1, r_2, \ldots, r_G\}$를 사용하여 계산되는 어드밴티지입니다.

$$A_{i}=\frac{r_{i}-\mathrm{mean}(\{r_{1},r_{2},\cdots,r_{G}\})}{\mathrm{std}(\{r_{1},r_{2},\cdots,r_{G}\})}$$

이 수식에서 어드밴티지는 개별 보상에서 그룹 평균을 빼고 그룹 표준편차로 정규화한 값으로, 각 출력이 그룹 내에서 얼마나 상대적으로 좋은 성능을 보이는지를 나타냅니다.

### 보상 모델링

보상은 훈련 신호의 원천으로서 강화학습의 최적화 방향을 결정합니다. DeepSeek-R1-Zero 훈련을 위해 연구진은 주로 두 가지 유형의 보상으로 구성된 규칙 기반 보상 시스템을 채택했습니다.

정확도 보상은 응답이 올바른지 평가합니다. 예를 들어, 결정적 결과를 가진 수학 문제의 경우 모델은 지정된 형식(예: 박스 안)으로 최종 답을 제공해야 하며, 이를 통해 정확성을 규칙 기반으로 신뢰성 있게 검증할 수 있습니다. 마찬가지로 LeetCode 문제의 경우 컴파일러를 사용하여 미리 정의된 테스트 케이스를 기반으로 피드백을 생성할 수 있습니다.

형식 보상은 정확도 보상 모델 외에도 모델이 사고 과정을 '<think>'와 '</think>' 태그 사이에 넣도록 강제하는 형식 보상 모델을 사용합니다.

연구진은 DeepSeek-R1-Zero 개발에서 결과 또는 과정 신경 보상 모델을 적용하지 않았습니다. 신경 보상 모델이 대규모 강화학습 과정에서 보상 해킹을 겪을 수 있고, 보상 모델을 재훈련하는 것이 추가적인 훈련 자원을 필요로 하며 전체 훈련 파이프라인을 복잡하게 만들기 때문입니다.

### 훈련 템플릿

DeepSeek-R1-Zero를 훈련하기 위해 연구진은 기본 모델이 지정된 지시사항을 준수하도록 안내하는 간단한 템플릿을 설계했습니다. 이 템플릿은 DeepSeek-R1-Zero가 먼저 추론 과정을 생성한 다음 최종 답을 제공하도록 요구합니다.

| 템플릿 구성 요소 | 내용 |
|-----------------|------|
| 대화 형식 | 사용자와 어시스턴트 간의 대화 |
| 사고 과정 | `<think>` 태그 내에 추론 과정 포함 |
| 최종 답변 | `<answer>` 태그 내에 답변 포함 |
| 프롬프트 | 구체적인 추론 질문으로 대체됨 |

연구진은 의도적으로 제약을 이러한 구조적 형식으로 제한하고, 성찰적 추론을 의무화하거나 특정 문제 해결 전략을 촉진하는 것과 같은 내용별 편향을 피했습니다. 이는 강화학습 과정에서 모델의 자연스러운 진행을 정확히 관찰할 수 있도록 하기 위함입니다.

### DeepSeek-R1-Zero의 성능, 자기 진화 과정 및 아하 모멘트

DeepSeek-R1-Zero는 강력한 추론 능력을 보여주며 예상치 못한 강력한 추론 행동들을 자율적으로 개발했지만, 가독성 문제와 언어 혼용과 같은 여러 문제에 직면했습니다. 추론 과정을 더 읽기 쉽게 만들고 오픈 커뮤니티와 공유하기 위해 연구진은 인간 친화적인 콜드 스타트 데이터와 함께 강화학습을 활용하는 방법인 DeepSeek-R1을 탐구했습니다.

![AIME 정확도 변화](https://arxiv.org/html/2501.12948/extracted/6147501/figures/plot_aime_with_maj.png)

위 그래프는 강화학습 훈련 과정 동안 DeepSeek-R1-Zero의 AIME 2024 벤치마크 성능 궤적을 보여줍니다. DeepSeek-R1-Zero는 강화학습 훈련이 진행됨에 따라 꾸준하고 일관된 성능 향상을 보여줍니다. 특히 AIME 2024에서 평균 pass@1 점수가 초기 15.6%에서 인상적인 71.0%로 크게 증가하여 OpenAI-o1-0912와 비교할 만한 성능 수준에 도달했습니다.

| 모델 | AIME 2024 | MATH-500 | GPQA | LiveCode | CodeForces | Diamond |
|------|-----------|----------|------|----------|------------|---------|
| | pass@1 | cons@64 | pass@1 | pass@1 | pass@1 | rating |
| OpenAI-o1-mini | 63.6 | 80.0 | 90.0 | 60.0 | 53.8 | 1820 |
| OpenAI-o1-0912 | 74.4 | 83.3 | 94.8 | 77.3 | 63.4 | 1843 |
| DeepSeek-R1-Zero | 71.0 | 86.7 | 95.9 | 73.3 | 50.0 | 1444 |

이 표는 DeepSeek-R1-Zero와 OpenAI o1 모델들 간의 추론 관련 벤치마크 비교를 제공합니다. 결과는 강화학습이 DeepSeek-R1-Zero가 지도 학습 미세 조정 데이터 없이도 강력한 추론 능력을 달성할 수 있게 한다는 것을 보여줍니다. 또한 다수결 투표를 적용하면 DeepSeek-R1-Zero의 성능을 더욱 향상시킬 수 있습니다. 예를 들어, AIME 벤치마크에서 다수결 투표를 사용하면 DeepSeek-R1-Zero의 성능이 71.0%에서 86.7%로 상승하여 OpenAI-o1-0912의 성능을 능가합니다.

![응답 길이 변화](https://arxiv.org/html/2501.12948/extracted/6147501/figures/plot_length.png)

DeepSeek-R1-Zero의 자기 진화 과정은 강화학습이 모델의 추론 능력을 자율적으로 향상시킬 수 있는 방법을 보여주는 매력적인 시연입니다. 기본 모델에서 직접 강화학습을 시작함으로써 지도 학습 미세 조정 단계의 영향 없이 모델의 진행을 면밀히 모니터링할 수 있습니다.

위 그래프에서 보듯이 DeepSeek-R1-Zero의 사고 시간은 훈련 과정 전반에 걸쳐 일관된 개선을 보여줍니다. 이러한 개선은 외부 조정의 결과가 아니라 모델 내부의 본질적인 발전입니다. DeepSeek-R1-Zero는 확장된 테스트 시간 계산을 활용하여 점점 더 복잡한 추론 과제를 해결하는 능력을 자연스럽게 습득합니다. 이 계산은 수백에서 수천 개의 추론 토큰을 생성하는 범위에 이르며, 모델이 사고 과정을 더 깊이 탐구하고 정제할 수 있게 합니다.

이러한 자기 진화의 가장 주목할 만한 측면 중 하나는 테스트 시간 계산이 증가함에 따라 정교한 행동들이 나타나는 것입니다. 모델이 이전 단계를 재검토하고 재평가하는 성찰과 문제 해결에 대한 대안적 접근법 탐구와 같은 행동들이 자발적으로 나타납니다. 이러한 행동들은 명시적으로 프로그래밍되지 않았지만 모델과 강화학습 환경의 상호작용 결과로 나타납니다.

DeepSeek-R1-Zero 훈련 중 관찰된 특히 흥미로운 현상은 "아하 모멘트"의 발생입니다. 이 순간은 모델의 중간 버전에서 발생하며, DeepSeek-R1-Zero가 초기 접근법을 재평가하여 문제에 더 많은 사고 시간을 할당하는 것을 학습합니다.

다음은 중간 버전 DeepSeek-R1-Zero의 흥미로운 "아하 모멘트" 예시입니다.

**질문**: $a > 1$일 때, $\sqrt{a-\sqrt{a+x}}=x$의 실근의 합은?

**응답**: 
```
<think>
방정식 $\sqrt{a-\sqrt{a+x}}=x$를 풀기 위해 양변을 제곱하는 것부터 시작해보겠습니다...
$(a-\sqrt{a+x})^2=x^2 \implies a-\sqrt{a+x}=x^2$
양변을 다시 정리하면: $\sqrt{a+x}=a-x^2$
다시 양변을 제곱하면: $(a-x^2)^2=a+x \implies a^2-2ax^2+(x^2)^2=a+x \implies x^4-2ax^2-x+(a^2-a)=0$

...잠깐, 잠깐. 잠깐. 여기서 아하 모멘트를 표시할 수 있습니다.
이 단계를 단계별로 재평가하여 올바른 합이 무엇인지 식별해보겠습니다...

우리는 다음 방정식으로 시작했습니다.
$\sqrt{a-\sqrt{a+x}}=x$
먼저 양변을 제곱합니다.
$a-\sqrt{a+x}=x^2 \implies \sqrt{a+x}=a-x^2$
다음으로 양변을 다시 제곱할 수 있습니다...
...
</think>
```

이 순간은 모델뿐만 아니라 그 행동을 관찰하는 연구자들에게도 "아하 모멘트"입니다. 이는 강화학습의 힘과 아름다움을 강조합니다. 모델에게 문제를 해결하는 방법을 명시적으로 가르치는 대신, 단순히 올바른 인센티브를 제공하면 모델이 자율적으로 고급 문제 해결 전략을 개발합니다.

이러한 "아하 모멘트"는 강화학습이 인공 시스템에서 새로운 수준의 지능을 열어줄 수 있는 잠재력을 보여주는 강력한 상기시켜주는 역할을 하며, 미래에 더욱 자율적이고 적응적인 모델을 위한 길을 열어줍니다.
## DeepSeek-R1: 콜드 스타트를 활용한 강화학습

DeepSeek-R1-Zero의 유망한 결과에서 영감을 받아 두 가지 자연스러운 질문이 제기됩니다. 첫째, 콜드 스타트로 소량의 고품질 데이터를 포함시켜 추론 성능을 더욱 향상시키거나 수렴을 가속화할 수 있을까요? 둘째, 명확하고 일관된 체인 오브 소트를 생성할 뿐만 아니라 강력한 일반 능력을 보여주는 사용자 친화적인 모델을 어떻게 훈련할 수 있을까요? 이러한 질문들을 해결하기 위해 연구진은 DeepSeek-R1을 훈련하는 파이프라인을 설계했습니다. 이 파이프라인은 네 단계로 구성됩니다.

### 콜드 스타트

DeepSeek-R1-Zero와 달리 DeepSeek-R1에서는 기본 모델로부터의 강화학습 훈련 초기 불안정한 콜드 스타트 단계를 방지하기 위해 소량의 긴 체인 오브 소트 데이터를 구성하고 수집하여 모델을 초기 강화학습 액터로 미세 조정합니다.

이러한 데이터를 수집하기 위해 연구진은 여러 접근법을 탐구했습니다. 긴 체인 오브 소트를 예시로 사용하는 퓨 샷 프롬프팅, 성찰과 검증을 포함한 상세한 답변을 생성하도록 모델에 직접 프롬프팅하기, 읽기 쉬운 형식으로 DeepSeek-R1-Zero 출력을 수집하기, 그리고 인간 주석자의 후처리를 통해 결과를 정제하는 방법들입니다. 본 연구에서는 DeepSeek-V3-Base를 강화학습의 시작점으로 미세 조정하기 위해 수천 개의 콜드 스타트 데이터를 수집했습니다.

DeepSeek-R1-Zero와 비교했을 때 콜드 스타트 데이터의 장점은 다음과 같습니다.

**가독성**: DeepSeek-R1-Zero의 주요 한계점은 내용이 종종 읽기에 적합하지 않다는 것입니다. 응답이 여러 언어를 혼용하거나 사용자를 위해 답변을 강조하는 마크다운 형식이 부족할 수 있습니다. 반면 DeepSeek-R1을 위한 콜드 스타트 데이터를 생성할 때는 각 응답 끝에 요약을 포함하고 독자 친화적이지 않은 응답을 필터링하는 읽기 쉬운 패턴을 설계했습니다. 여기서 출력 형식을 `|special_token|<reasoning_process>|special_token|<summary>`로 정의하는데, 추론 과정은 질의에 대한 체인 오브 소트이고 요약은 추론 결과를 요약하는 데 사용됩니다.

**잠재력**: 인간의 사전 지식으로 콜드 스타트 데이터의 패턴을 신중하게 설계함으로써 DeepSeek-R1-Zero 대비 더 나은 성능을 관찰했습니다. 연구진은 반복적 훈련이 추론 모델에게 더 나은 방법이라고 믿습니다.

### 추론 지향 강화학습

콜드 스타트 데이터로 DeepSeek-V3-Base를 미세 조정한 후, DeepSeek-R1-Zero에서 사용된 것과 동일한 대규모 강화학습 훈련 과정을 적용합니다. 이 단계는 모델의 추론 능력 향상에 중점을 두며, 특히 코딩, 수학, 과학, 논리적 추론과 같은 추론 집약적 과제에서 명확한 해결책이 있는 잘 정의된 문제들을 다룹니다.

훈련 과정에서 체인 오브 소트가 종종 언어 혼용을 보이는 것을 관찰했는데, 특히 강화학습 프롬프트가 여러 언어를 포함할 때 그렇습니다. 언어 혼용 문제를 완화하기 위해 강화학습 훈련 중에 언어 일관성 보상을 도입했습니다. 이는 체인 오브 소트에서 목표 언어 단어의 비율로 계산됩니다. 절제 실험에서 이러한 정렬이 모델 성능의 약간의 저하를 가져오지만, 이 보상은 인간 선호도와 일치하여 더 읽기 쉽게 만듭니다.

최종적으로 추론 과제의 정확도와 언어 일관성에 대한 보상을 직접 합산하여 최종 보상을 형성합니다. 그런 다음 미세 조정된 모델에 강화학습 훈련을 적용하여 추론 과제에서 수렴에 도달할 때까지 진행합니다.

### 거부 샘플링과 지도 학습 미세 조정

추론 지향 강화학습이 수렴하면, 결과 체크포인트를 활용하여 후속 라운드를 위한 지도 학습 미세 조정 데이터를 수집합니다. 주로 추론에 중점을 둔 초기 콜드 스타트 데이터와 달리, 이 단계는 다른 도메인의 데이터를 통합하여 글쓰기, 역할 연기, 기타 범용 과제에서 모델의 능력을 향상시킵니다.

구체적으로 다음과 같이 데이터를 생성하고 모델을 미세 조정합니다.

**추론 데이터**: 추론 프롬프트를 큐레이션하고 위 강화학습 훈련의 체크포인트에서 거부 샘플링을 수행하여 추론 궤적을 생성합니다. 이전 단계에서는 규칙 기반 보상으로 평가할 수 있는 데이터만 포함했지만, 이 단계에서는 일부가 정답과 모델 예측을 DeepSeek-V3에 입력하여 판단하는 생성적 보상 모델을 사용하는 추가 데이터를 포함하여 데이터셋을 확장합니다.

또한 모델 출력이 때때로 혼란스럽고 읽기 어렵기 때문에 언어가 혼용되고 긴 문단과 코드 블록이 있는 체인 오브 소트를 필터링했습니다. 각 프롬프트에 대해 여러 응답을 샘플링하고 올바른 것만 유지합니다. 총 약 60만 개의 추론 관련 훈련 샘플을 수집했습니다.

**비추론 데이터**: 글쓰기, 사실적 질의응답, 자기 인식, 번역과 같은 비추론 데이터의 경우 DeepSeek-V3 파이프라인을 채택하고 DeepSeek-V3의 지도 학습 미세 조정 데이터셋의 일부를 재사용합니다. 특정 비추론 과제의 경우 프롬프팅을 통해 질문에 답하기 전에 잠재적인 체인 오브 소트를 생성하도록 DeepSeek-V3를 호출합니다. 하지만 "안녕하세요"와 같은 간단한 질의의 경우 응답에 체인 오브 소트를 제공하지 않습니다. 최종적으로 추론과 관련이 없는 약 20만 개의 훈련 샘플을 수집했습니다.

약 80만 개 샘플로 구성된 위 큐레이션된 데이터셋을 사용하여 DeepSeek-V3-Base를 2 에포크 동안 미세 조정합니다.

### 모든 시나리오를 위한 강화학습

모델을 인간 선호도와 더욱 일치시키기 위해 모델의 유용성과 무해성을 개선하는 동시에 추론 능력을 정제하는 것을 목표로 하는 2차 강화학습 단계를 구현합니다. 구체적으로 보상 신호와 다양한 프롬프트 분포의 조합을 사용하여 모델을 훈련합니다.

추론 데이터의 경우 수학, 코드, 논리적 추론 도메인에서 학습 과정을 안내하기 위해 규칙 기반 보상을 활용하는 DeepSeek-R1-Zero에서 설명된 방법론을 준수합니다. 일반 데이터의 경우 복잡하고 미묘한 시나리오에서 인간 선호도를 포착하기 위해 보상 모델에 의존합니다. DeepSeek-V3 파이프라인을 기반으로 구축하고 유사한 선호도 쌍과 훈련 프롬프트 분포를 채택합니다.

유용성의 경우 최종 요약에만 독점적으로 초점을 맞춰 평가가 기본 추론 과정에 대한 간섭을 최소화하면서 사용자에게 응답의 유용성과 관련성을 강조하도록 보장합니다. 무해성의 경우 추론 과정과 요약을 모두 포함한 모델의 전체 응답을 평가하여 생성 과정에서 발생할 수 있는 잠재적 위험, 편향 또는 유해한 콘텐츠를 식별하고 완화합니다.

궁극적으로 보상 신호와 다양한 데이터 분포의 통합을 통해 유용성과 무해성을 우선시하면서 추론에서 뛰어난 모델을 훈련할 수 있습니다.
## 증류: 작은 모델에 추론 능력 부여

DeepSeek-R1과 같은 추론 능력을 더 효율적인 작은 모델들에 부여하기 위해 연구진은 오픈소스 모델들을 직접 미세 조정하는 접근법을 채택했습니다. 이 과정에서 DeepSeek-R1로 큐레이션된 80만 개의 샘플을 활용하여 Qwen과 Llama 계열의 다양한 크기 모델들을 훈련했습니다.

### 기본 모델 선정과 훈련 전략

연구진이 선택한 기본 모델들은 Qwen2.5-Math-1.5B, Qwen2.5-Math-7B, Qwen2.5-14B, Qwen2.5-32B, Llama-3.1-8B, 그리고 Llama-3.3-70B-Instruct입니다. 특히 Llama-3.3을 선택한 이유는 Llama-3.1보다 추론 능력이 약간 더 우수하기 때문입니다.

증류된 모델들의 경우 지도 학습 미세 조정(SFT)만을 적용하고 강화학습 단계는 포함하지 않았습니다. 강화학습을 통합하면 모델 성능을 상당히 향상시킬 수 있음에도 불구하고, 연구진의 주요 목표는 증류 기법 자체의 효과성을 입증하는 것이었습니다. 강화학습 단계의 탐구는 더 넓은 연구 커뮤니티에 맡기는 것으로 결정했습니다.

### 증류 과정의 핵심 특징

이러한 직접적인 증류 방법은 작은 모델들의 추론 능력을 현저히 향상시키는 것으로 나타났습니다. 큰 모델에서 발견된 추론 패턴을 작은 모델로 전달함으로써, 작은 모델도 복잡한 추론 과제를 효과적으로 수행할 수 있게 되었습니다. 이는 계산 자원이 제한된 환경에서도 고품질의 추론 능력을 활용할 수 있는 실용적인 해결책을 제공합니다.

증류 접근법의 단순함에도 불구하고 그 효과는 매우 인상적입니다. 복잡한 다단계 훈련 파이프라인 없이도 DeepSeek-R1의 추론 패턴을 성공적으로 작은 모델들에 전달할 수 있었으며, 이는 지식 증류가 추론 능력 향상에 있어 강력하고 효율적인 방법임을 보여줍니다.
## 실험 벤치마크

DeepSeek-R1의 성능을 종합적으로 평가하기 위해 연구진은 다양한 도메인과 난이도를 포괄하는 광범위한 벤치마크 세트를 구성했습니다. 평가 대상 벤치마크는 지식 평가를 위한 MMLU, MMLU-Redux, MMLU-Pro, C-Eval, CMMLU와 같은 교육 지향적 벤치마크부터 IFEval, FRAMES, GPQA Diamond, SimpleQA, C-SimpleQA와 같은 특수 능력 평가 벤치마크까지 포함됩니다.

코딩 능력 평가를 위해서는 SWE-Bench Verified, Aider, LiveCodeBench(2024년 8월부터 2025년 1월까지의 데이터), Codeforces 등이 사용되었습니다. 수학적 추론 능력 평가에는 중국 전국 고등학교 수학 올림피아드(CNMO 2024)와 미국 수학 초청 시험 2024(AIME 2024)가 포함되었습니다.

표준 벤치마크 외에도 연구진은 LLM을 판정자로 활용하는 개방형 생성 과제에서도 모델을 평가했습니다. AlpacaEval 2.0과 Arena-Hard의 원래 구성을 따라 GPT-4-Turbo-1106을 판정자로 사용하여 쌍별 비교를 수행했습니다. 길이 편향을 방지하기 위해 최종 요약만을 평가에 제공했습니다.

증류된 모델들의 경우 AIME 2024, MATH-500, GPQA Diamond, Codeforces, LiveCodeBench에서의 대표적인 결과를 보고했습니다.

### 평가 프롬프트 설정

DeepSeek-V3의 설정을 따라 MMLU, DROP, GPQA Diamond, SimpleQA와 같은 표준 벤치마크는 simple-evals 프레임워크의 프롬프트를 사용하여 평가되었습니다. MMLU-Redux의 경우 Zero-Eval 프롬프트 형식을 제로샷 설정에서 채택했습니다.

MMLU-Pro, C-Eval, CLUE-WSC의 경우 원래 프롬프트가 퓨샷 방식이었으므로 DeepSeek-R1에 적합하도록 제로샷 설정으로 약간 수정했습니다. 퓨샷에서의 체인 오브 소트가 DeepSeek-R1의 성능을 저해할 수 있기 때문입니다. 다른 데이터셋들은 제작자가 제공한 기본 프롬프트와 함께 원래의 평가 프로토콜을 따랐습니다.

코드와 수학 벤치마크의 경우 HumanEval-Mul 데이터셋은 8개의 주요 프로그래밍 언어(Python, Java, C++, C#, JavaScript, TypeScript, PHP, Bash)를 다룹니다. LiveCodeBench에서의 모델 성능은 체인 오브 소트 형식을 사용하여 평가되었으며, 2024년 8월부터 2025년 1월까지 수집된 데이터를 사용했습니다.

Codeforces 데이터셋은 10개의 Div.2 대회 문제들과 전문가가 제작한 테스트 케이스를 사용하여 평가되었으며, 이후 예상 등급과 경쟁자 백분위수가 계산되었습니다. SWE-Bench 검증 결과는 agentless 프레임워크를 통해 얻어졌습니다. AIDER 관련 벤치마크는 "diff" 형식을 사용하여 측정되었습니다.

모든 벤치마크에서 DeepSeek-R1의 출력은 최대 32,768 토큰으로 제한되었습니다.

### 기준 모델

연구진은 DeepSeek-V3, Claude-Sonnet-3.5-1022, GPT-4o-0513, OpenAI-o1-mini, OpenAI-o1-1217을 포함한 여러 강력한 기준 모델들과 종합적인 평가를 수행했습니다. 중국 본토에서 OpenAI-o1-1217 API에 접근하기 어려운 상황으로 인해 공식 보고서를 기반으로 성능을 보고했습니다. 증류된 모델들의 경우 오픈소스 모델인 QwQ-32B-Preview와도 비교했습니다.

### 평가 설정

모델의 최대 생성 길이를 32,768 토큰으로 설정했습니다. 긴 출력 추론 모델을 그리디 디코딩으로 평가하면 높은 반복률과 서로 다른 체크포인트 간의 상당한 변동성이 발생한다는 것을 발견했습니다. 따라서 기본적으로 pass@$k$ 평가를 사용하고 0이 아닌 온도를 사용하여 pass@1을 보고했습니다.

구체적으로 샘플링 온도 $0.6$과 top-$p$ 값 $0.95$를 사용하여 각 질문에 대해 $k$개의 응답을 생성했습니다(일반적으로 테스트 세트 크기에 따라 $4$에서 $64$ 사이). Pass@1은 다음과 같이 계산됩니다.

$$\text{pass@1} = \frac{1}{k}\sum_{i=1}^{k}p_{i}$$

여기서 $p_i$는 $i$번째 응답의 정확성을 나타냅니다. 이 방법은 더 신뢰할 수 있는 성능 추정치를 제공합니다. AIME 2024의 경우 64개 샘플을 사용한 합의(다수결 투표) 결과도 보고했으며, 이를 $\text{cons}@64$로 표시했습니다.

## DeepSeek-R1 평가 결과

![DeepSeek-R1 성능 비교](https://arxiv.org/html/2501.12948/x1.png)

| 벤치마크 (지표) | Claude-3.5-Sonnet-1022 | GPT-4o-0513 | DeepSeek-V3 | OpenAI-o1-mini | OpenAI-o1-1217 | DeepSeek-R1 |
|---|---|---|---|---|---|---|
| **아키텍처** | - | - | MoE | - | - | MoE |
| **활성화된 파라미터** | - | - | 37B | - | - | 37B |
| **전체 파라미터** | - | - | 671B | - | - | 671B |
| **영어** | | | | | | |
| MMLU (Pass@1) | 88.3 | 87.2 | 88.5 | 85.2 | 91.8 | 90.8 |
| MMLU-Redux (EM) | 88.9 | 88.0 | 89.1 | 86.7 | - | 92.9 |
| MMLU-Pro (EM) | 78.0 | 72.6 | 75.9 | 80.3 | - | 84.0 |
| DROP (3-shot F1) | 88.3 | 83.7 | 91.6 | 83.9 | 90.2 | 92.2 |
| IF-Eval (Prompt Strict) | 86.5 | 84.3 | 86.1 | 84.8 | - | 83.3 |
| GPQA Diamond (Pass@1) | 65.0 | 49.9 | 59.1 | 60.0 | 75.7 | 71.5 |
| SimpleQA (Correct) | 28.4 | 38.2 | 24.9 | 7.0 | 47.0 | 30.1 |
| FRAMES (Acc.) | 72.5 | 80.5 | 73.3 | 76.9 | - | 82.5 |
| AlpacaEval2.0 (LC-winrate) | 52.0 | 51.1 | 70.0 | 57.8 | - | 87.6 |
| ArenaHard (GPT-4-1106) | 85.2 | 80.4 | 85.5 | 92.0 | - | 92.3 |
| **코드** | | | | | | |
| LiveCodeBench (Pass@1-COT) | 38.9 | 32.9 | 36.2 | 53.8 | 63.4 | 65.9 |
| Codeforces (Percentile) | 20.3 | 23.6 | 58.7 | 93.4 | 96.6 | 96.3 |
| Codeforces (Rating) | 717 | 759 | 1134 | 1820 | 2061 | 2029 |
| SWE Verified (Resolved) | 50.8 | 38.8 | 42.0 | 41.6 | 48.9 | 49.2 |
| Aider-Polyglot (Acc.) | 45.3 | 16.0 | 49.6 | 32.9 | 61.7 | 53.3 |
| **수학** | | | | | | |
| AIME 2024 (Pass@1) | 16.0 | 9.3 | 39.2 | 63.6 | 79.2 | 79.8 |
| MATH-500 (Pass@1) | 78.3 | 74.6 | 90.2 | 90.0 | 96.4 | 97.3 |
| CNMO 2024 (Pass@1) | 13.1 | 10.8 | 43.2 | 67.6 | - | 78.8 |
| **중국어** | | | | | | |
| CLUE-WSC (EM) | 85.4 | 87.9 | 90.9 | 89.9 | - | 92.8 |
| C-Eval (EM) | 76.7 | 76.0 | 86.5 | 68.9 | - | 91.8 |
| C-SimpleQA (Correct) | 55.4 | 58.7 | 68.0 | 40.3 | - | 63.7 |

교육 지향적 지식 벤치마크인 MMLU, MMLU-Pro, GPQA Diamond에서 DeepSeek-R1은 DeepSeek-V3 대비 우수한 성능을 보여줍니다. 이러한 개선은 주로 STEM 관련 질문에서의 정확도 향상에 기인하며, 대규모 강화학습을 통해 상당한 성과를 달성했습니다.

DeepSeek-R1은 긴 맥락 의존적 질의응답 과제인 FRAMES에서도 뛰어난 성능을 보여 강력한 문서 분석 능력을 입증했습니다. 이는 AI 기반 검색 및 데이터 분석 과제에서 추론 모델의 잠재력을 강조합니다.

사실적 벤치마크인 SimpleQA에서 DeepSeek-R1은 DeepSeek-V3를 능가하여 사실 기반 질의 처리 능력을 보여줍니다. OpenAI-o1이 GPT-4o를 능가하는 유사한 경향이 관찰됩니다. 하지만 DeepSeek-R1은 중국어 SimpleQA 벤치마크에서 DeepSeek-V3보다 낮은 성능을 보이는데, 이는 주로 안전 강화학습 후 특정 질의에 대한 답변 거부 경향 때문입니다. 안전 강화학습 없이는 DeepSeek-R1이 70% 이상의 정확도를 달성할 수 있었습니다.

DeepSeek-R1은 모델의 형식 지시 준수 능력을 평가하는 벤치마크인 IF-Eval에서도 인상적인 결과를 보여줍니다. 이러한 개선은 지도 학습 미세 조정과 강화학습 훈련의 최종 단계에서 지시 준수 데이터를 포함한 것과 연결될 수 있습니다.

AlpacaEval2.0과 ArenaHard에서 주목할 만한 성능이 관찰되어 DeepSeek-R1의 글쓰기 과제와 개방형 질의응답에서의 강점을 나타냅니다. DeepSeek-V3 대비 상당한 성능 향상은 대규모 강화학습의 일반화 이점을 강조하며, 이는 추론 능력을 향상시킬 뿐만 아니라 다양한 도메인에서의 성능도 개선합니다.

또한 DeepSeek-R1이 생성하는 요약 길이는 간결하여 ArenaHard에서 평균 689 토큰, AlpacaEval 2.0에서 평균 2,218 문자를 기록했습니다. 이는 DeepSeek-R1이 GPT 기반 평가에서 길이 편향을 도입하지 않음을 나타내며, 여러 과제에서의 견고성을 더욱 확고히 합니다.

수학 과제에서 DeepSeek-R1은 OpenAI-o1-1217과 동등한 성능을 보여주며 다른 모델들을 큰 차이로 능가합니다. LiveCodeBench와 Codeforces와 같은 코딩 알고리즘 과제에서도 유사한 경향이 관찰되며, 추론 중심 모델들이 이러한 벤치마크를 지배하고 있습니다.

엔지니어링 지향적 코딩 과제에서는 OpenAI-o1-1217이 Aider에서 DeepSeek-R1을 능가하지만 SWE Verified에서는 비교할 만한 성능을 달성합니다. 현재 관련 강화학습 훈련 데이터의 양이 매우 제한적이므로 DeepSeek-R1의 엔지니어링 성능은 다음 버전에서 개선될 것으로 예상됩니다.

## 증류된 모델 평가

| 모델 | AIME 2024 | MATH-500 | GPQA Diamond | LiveCodeBench | CodeForces |
|---|---|---|---|---|---|
| | pass@1 | cons@64 | pass@1 | pass@1 | pass@1 | rating |
| GPT-4o-0513 | 9.3 | 13.4 | 74.6 | 49.9 | 32.9 | 759 |
| Claude-3.5-Sonnet-1022 | 16.0 | 26.7 | 78.3 | 65.0 | 38.9 | 717 |
| OpenAI-o1-mini | 63.6 | 80.0 | 90.0 | 60.0 | 53.8 | 1820 |
| QwQ-32B-Preview | 50.0 | 60.0 | 90.6 | 54.5 | 41.9 | 1316 |
| DeepSeek-R1-Distill-Qwen-1.5B | 28.9 | 52.7 | 83.9 | 33.8 | 16.9 | 954 |
| DeepSeek-R1-Distill-Qwen-7B | 55.5 | 83.3 | 92.8 | 49.1 | 37.6 | 1189 |
| DeepSeek-R1-Distill-Qwen-14B | 69.7 | 80.0 | 93.9 | 59.1 | 53.1 | 1481 |
| DeepSeek-R1-Distill-Qwen-32B | 72.6 | 83.3 | 94.3 | 62.1 | 57.2 | 1691 |
| DeepSeek-R1-Distill-Llama-8B | 50.4 | 80.0 | 89.1 | 49.0 | 39.6 | 1205 |
| DeepSeek-R1-Distill-Llama-70B | 70.0 | 86.7 | 94.5 | 65.2 | 57.5 | 1633 |

위 표에서 보듯이 단순히 DeepSeek-R1의 출력을 증류하는 것만으로도 효율적인 DeepSeek-R1-7B(즉, DeepSeek-R1-Distill-Qwen-7B, 이하 유사하게 축약)가 GPT-4o-0513과 같은 비추론 모델들을 전반적으로 능가할 수 있게 됩니다.

DeepSeek-R1-14B는 모든 평가 지표에서 QwQ-32B-Preview를 능가하며, DeepSeek-R1-32B와 DeepSeek-R1-70B는 대부분의 벤치마크에서 o1-mini를 상당히 초과합니다. 이러한 결과는 증류의 강력한 잠재력을 보여줍니다.

또한 연구진은 이러한 증류된 모델들에 강화학습을 적용하면 상당한 추가 성과를 얻을 수 있음을 발견했습니다. 이는 더 많은 탐구가 필요한 영역이라고 판단하여 여기서는 단순한 지도 학습 미세 조정으로 증류된 모델들의 결과만을 제시합니다.
## 토론

### 증류 대 강화학습

DeepSeek-R1의 개발 과정에서 중요한 질문이 제기되었습니다. 3.2절에서 확인할 수 있듯이 DeepSeek-R1을 증류하여 작은 모델이 인상적인 결과를 달성할 수 있었지만, 여전히 한 가지 의문이 남아있었습니다. 증류 없이 논문에서 논의된 대규모 강화학습 훈련만으로도 모델이 비교할 만한 성능을 달성할 수 있을까요?

이 질문에 답하기 위해 연구진은 Qwen-32B-Base에 수학, 코드, STEM 데이터를 사용하여 10,000단계 이상의 대규모 강화학습 훈련을 수행하여 DeepSeek-R1-Zero-Qwen-32B를 개발했습니다.

| 모델 | AIME 2024 | MATH-500 | GPQA Diamond | LiveCodeBench | pass@1 |
|---|---|---|---|---|---|
| | pass@1 | cons@64 | pass@1 | pass@1 | |
| QwQ-32B-Preview | 50.0 | 60.0 | 90.6 | 54.5 | 41.9 |
| DeepSeek-R1-Zero-Qwen-32B | 47.0 | 60.0 | 91.6 | 55.0 | 40.2 |
| DeepSeek-R1-Distill-Qwen-32B | 72.6 | 83.3 | 94.3 | 62.1 | 57.2 |

실험 결과는 32B 기본 모델이 대규모 강화학습 훈련 후 QwQ-32B-Preview와 동등한 성능을 달성함을 보여줍니다. 하지만 DeepSeek-R1에서 증류된 DeepSeek-R1-Distill-Qwen-32B는 모든 벤치마크에서 DeepSeek-R1-Zero-Qwen-32B를 크게 능가하는 성능을 보였습니다.

이러한 결과로부터 두 가지 중요한 결론을 도출할 수 있습니다. 첫째, 더 강력한 모델을 작은 모델로 증류하는 것은 뛰어난 결과를 가져오는 반면, 작은 모델이 본 논문에서 언급된 대규모 강화학습에 의존하는 경우 엄청난 계산 능력이 필요하며 증류의 성능에도 미치지 못할 수 있습니다. 둘째, 증류 전략이 경제적이고 효과적이지만, 지능의 경계를 넘어서는 발전을 위해서는 여전히 더 강력한 기본 모델과 더 대규모의 강화학습이 필요할 수 있습니다.

### 실패한 시도들

DeepSeek-R1 개발 초기 단계에서 연구진은 실패와 좌절도 경험했습니다. 이러한 실패 경험을 공유함으로써 통찰을 제공하고자 하지만, 이것이 이러한 접근법들이 효과적인 추론 모델을 개발할 수 없다는 것을 의미하지는 않습니다.

#### 프로세스 보상 모델 (PRM)

프로세스 보상 모델은 추론 과제에 대한 더 나은 접근법으로 모델을 안내하는 합리적인 방법입니다. 이는 [Let's Verify Step by Step](https://arxiv.org/pdf/2305.20050) 연구에서 제안된 접근법으로, 결과 기반 감독보다 프로세스 기반 감독이 수학적 추론에서 훨씬 더 신뢰할 수 있는 보상 모델을 훈련할 수 있음을 보여주었습니다. 또한 [Math-Shepherd](https://arxiv.org/pdf/2312.08935) 연구에서는 자동 프로세스 주석 프레임워크를 통해 인간 주석에 대한 의존도를 줄이는 방법을 제시했습니다.

하지만 실제로 PRM은 궁극적인 성공을 방해할 수 있는 세 가지 주요 한계점을 가지고 있습니다. 첫째, 일반적인 추론에서 세밀한 단계를 명시적으로 정의하는 것이 어렵습니다. 둘째, 현재 중간 단계가 올바른지 판단하는 것은 도전적인 과제입니다. 모델을 사용한 자동 주석은 만족스러운 결과를 얻지 못할 수 있으며, 수동 주석은 확장에 도움이 되지 않습니다. 셋째, 모델 기반 PRM이 도입되면 필연적으로 보상 해킹으로 이어지며, 보상 모델을 재훈련하는 것은 추가적인 훈련 자원이 필요하고 전체 훈련 파이프라인을 복잡하게 만듭니다.

[Scaling Laws for Reward Model Overoptimization](https://arxiv.org/pdf/2210.10760) 연구에서 보여준 바와 같이, 보상 모델 과최적화는 실제 성능 저하를 가져올 수 있습니다. 이 연구는 강화학습 과정에서 프록시 보상 모델을 과도하게 최적화할 때 발생하는 문제점들을 정량적으로 분석했습니다.

결론적으로 PRM이 모델에서 생성된 상위 N개 응답을 재순위화하거나 안내된 탐색을 지원하는 좋은 능력을 보여주지만, 대규모 강화학습 과정에서 도입하는 추가적인 계산 오버헤드에 비해 그 장점은 제한적입니다.

#### 몬테카를로 트리 탐색 (MCTS)

[AlphaGo](https://arxiv.org/pdf/1712.01815)와 [AlphaZero](https://arxiv.org/pdf/1712.01815)에서 영감을 받아 연구진은 몬테카를로 트리 탐색을 사용하여 테스트 시간 계산 확장성을 향상시키는 방법을 탐구했습니다. 이 접근법은 답을 더 작은 부분으로 나누어 모델이 해결 공간을 체계적으로 탐색할 수 있도록 합니다.

이를 촉진하기 위해 연구진은 탐색에 필요한 특정 추론 단계에 해당하는 여러 태그를 생성하도록 모델에 프롬프트를 제공했습니다. 훈련을 위해 먼저 수집된 프롬프트를 사용하여 사전 훈련된 가치 모델의 안내를 받는 MCTS를 통해 답을 찾습니다. 그 후 결과로 나온 질문-답변 쌍을 사용하여 액터 모델과 가치 모델을 모두 훈련하여 과정을 반복적으로 정제합니다.

하지만 이 접근법은 훈련을 확장할 때 여러 도전에 직면합니다. 첫째, 체스와 달리 탐색 공간이 상대적으로 잘 정의된 것과 달리, 토큰 생성은 기하급수적으로 더 큰 탐색 공간을 제시합니다. 이를 해결하기 위해 각 노드에 대한 최대 확장 제한을 설정했지만, 이는 모델이 지역 최적해에 갇히게 할 수 있습니다.

둘째, 가치 모델이 탐색 과정의 각 단계를 안내하므로 생성 품질에 직접적인 영향을 미칩니다. 세밀한 가치 모델을 훈련하는 것은 본질적으로 어려우며, 이는 모델이 반복적으로 개선하는 것을 어렵게 만듭니다. AlphaGo의 핵심 성공은 성능을 점진적으로 향상시키기 위한 가치 모델 훈련에 의존했지만, 토큰 생성의 복잡성으로 인해 이 원리를 우리의 설정에서 복제하기는 어려웠습니다.

[Scaling LLM Test-Time Compute Optimally](https://arxiv.org/pdf/2408.03314) 연구에서도 유사한 도전을 확인할 수 있습니다. 이 연구는 테스트 시간 계산 확장의 다양한 메커니즘을 분석했으며, 프로세스 기반 검증자에 대한 탐색과 제안 분포 정제 간의 트레이드오프를 보여주었습니다.

결론적으로 MCTS가 사전 훈련된 가치 모델과 결합될 때 추론 중 성능을 향상시킬 수 있지만, 자기 탐색을 통해 모델 성능을 반복적으로 향상시키는 것은 여전히 상당한 도전으로 남아있습니다.
## 결론, 한계점, 그리고 향후 연구 방향

본 연구에서는 강화학습을 통해 모델의 추론 능력을 향상시키는 여정을 공유했습니다. DeepSeek-R1-Zero는 콜드 스타트 데이터에 의존하지 않는 순수한 강화학습 접근법을 나타내며, 다양한 과제에서 강력한 성능을 달성했습니다. DeepSeek-R1은 콜드 스타트 데이터와 반복적 강화학습 미세 조정을 활용하여 더욱 강력한 성능을 보여주었습니다. 궁극적으로 DeepSeek-R1은 다양한 과제에서 OpenAI-o1-1217과 비교할 만한 성능을 달성했습니다.

연구진은 추론 능력을 작은 밀집 모델들로 증류하는 방법도 탐구했습니다. DeepSeek-R1을 교사 모델로 사용하여 80만 개의 훈련 샘플을 생성하고, 여러 작은 밀집 모델들을 미세 조정했습니다. 결과는 매우 유망했습니다. DeepSeek-R1-Distill-Qwen-1.5B는 수학 벤치마크에서 AIME 28.9%, MATH 83.9%를 달성하여 GPT-4o와 Claude-3.5-Sonnet을 능가했습니다. 다른 밀집 모델들도 인상적인 결과를 달성하여 동일한 기본 체크포인트를 기반으로 한 다른 지시 조정 모델들을 크게 능가했습니다.

### 향후 연구 방향

DeepSeek-R1의 향후 연구를 위해 다음과 같은 방향에 투자할 계획입니다.

**일반 능력 향상**: 현재 DeepSeek-R1의 능력은 함수 호출, 다중 턴 대화, 복잡한 역할 연기, JSON 출력과 같은 과제에서 DeepSeek-V3에 미치지 못합니다. 앞으로 긴 체인 오브 소트가 이러한 분야의 과제를 향상시키는 데 어떻게 활용될 수 있는지 탐구할 계획입니다. 이는 추론 모델의 범용성을 확대하는 중요한 연구 영역입니다.

**언어 혼용 문제 해결**: DeepSeek-R1은 현재 중국어와 영어에 최적화되어 있어, 다른 언어로 된 질의를 처리할 때 언어 혼용 문제가 발생할 수 있습니다. 예를 들어, DeepSeek-R1은 질의가 영어나 중국어가 아닌 다른 언어로 되어 있어도 추론과 응답에 영어를 사용할 수 있습니다. 향후 업데이트에서 이러한 한계점을 해결하고자 합니다.

**프롬프트 엔지니어링 최적화**: DeepSeek-R1을 평가하는 과정에서 모델이 프롬프트에 민감하다는 것을 관찰했습니다. 퓨 샷 프롬프팅은 지속적으로 성능을 저하시킵니다. 따라서 최적의 결과를 위해 사용자들이 문제를 직접 설명하고 제로샷 설정에서 출력 형식을 지정하는 것을 권장합니다. 이는 추론 모델의 특성상 나타나는 현상으로, 향후 연구에서 프롬프트 민감도를 줄이는 방법을 모색할 필요가 있습니다.

**소프트웨어 엔지니어링 과제 개선**: 긴 평가 시간으로 인해 강화학습 과정의 효율성에 영향을 미치기 때문에, 대규모 강화학습이 소프트웨어 엔지니어링 과제에 광범위하게 적용되지 못했습니다. 그 결과 DeepSeek-R1은 소프트웨어 엔지니어링 벤치마크에서 DeepSeek-V3 대비 큰 개선을 보여주지 못했습니다. 향후 버전에서는 소프트웨어 엔지니어링 데이터에 대한 거부 샘플링을 구현하거나 강화학습 과정 중 비동기 평가를 통합하여 효율성을 개선함으로써 이 문제를 해결할 예정입니다.

이러한 연구 방향들은 DeepSeek-R1의 한계점을 체계적으로 해결하고 추론 모델의 실용성과 범용성을 크게 향상시킬 것으로 기대됩니다. 특히 언어 혼용 문제 해결과 소프트웨어 엔지니어링 능력 향상은 글로벌 사용자들에게 더욱 유용한 추론 모델을 제공하는 데 핵심적인 역할을 할 것입니다.
이 논문의 참고문헌 목록은 DeepSeek-R1 개발에 활용된 광범위한 연구 기반을 보여줍니다. 참고문헌들은 대규모 언어 모델, 강화학습, 추론 능력 평가, 그리고 코드 생성 등 다양한 AI/ML 분야의 핵심 연구들을 포괄하고 있습니다.

특히 주목할 만한 것은 OpenAI의 o1 시리즈 모델들과 관련된 최신 연구들, 그리고 수학적 추론과 코드 생성 능력을 평가하기 위한 다양한 벤치마크들이 포함되어 있다는 점입니다. 이러한 참고문헌들은 DeepSeek-R1의 성능을 객관적으로 평가하고 기존 연구와의 비교 분석을 가능하게 하는 중요한 기준점들을 제공합니다.

## 부록: 기여자 및 감사의 말

DeepSeek-R1 프로젝트는 다양한 전문 분야의 연구자들과 엔지니어들의 협력을 통해 완성되었습니다. 핵심 기여자들은 모델 아키텍처 설계, 강화학습 알고리즘 개발, 대규모 훈련 파이프라인 구축, 그리고 종합적인 평가 시스템 개발에 중요한 역할을 담당했습니다.

프로젝트의 성공적인 완수를 위해 기여한 모든 연구자들과 엔지니어들의 전문성과 헌신이 DeepSeek-R1의 혁신적인 추론 능력 개발을 가능하게 했습니다. 특히 강화학습 기반 추론 모델 개발이라는 도전적인 과제를 해결하기 위해 다학제적 접근법을 통해 이론적 연구와 실용적 구현을 성공적으로 결합했습니다.

이러한 협력적 연구 환경은 DeepSeek-R1이 단순히 기술적 성과를 넘어서 AI 연구 커뮤니티 전체에 기여할 수 있는 오픈소스 모델로 발전할 수 있는 기반을 제공했습니다. 연구진의 다양한 배경과 전문성이 결합되어 추론 능력 향상이라는 복잡한 문제에 대한 포괄적이고 혁신적인 해결책을 제시할 수 있었습니다.
- - -
### References
* [DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning](http://arxiv.org/pdf/2501.12948v1)